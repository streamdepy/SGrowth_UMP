<main class="flex flex-col ml-48 self-center mb-16 mt-16 w-full max-w-[1256px] max-md:mt-10 max-md:max-w-full">
  <header class="flex gap-3.5 self-start">
    <img
      src="https://api.builder.io/api/v1/image/assets/TEMP/1c71a2a9be3de365531c3991c3339c7e3c083b53?width=462"
      alt="GRI Environment icon"
      class="object-contain shrink-0 my-auto rounded-full aspect-[1.04] w-[58px]"
    />
    <div class="flex flex-col">
      <h2 class="text-4xl font-semibold text-black">GRI Environment</h2>
      <p class="self-center text-xl font-medium leading-none text-center text-gray-500">
        Environmental Performance
      </p>
    </div>
  </header>

  <form action="/umkm/env-2" method="POST">
    <!-- Scope 3 GHG Emissions (Other Indirect) -->
    <section class="flex flex-col items-start py-14 px-16 mt-10 w-full bg-white rounded-2xl shadow-2xl max-w-[981px] max-md:px-5">
      <h3 class="text-3xl font-semibold text-teal-700">Other Indirect (Scope 3) GHG Emissions (305-3)</h3>
      <p class="mt-3 text-gray-500">Fill in the other indirect (Scope 3) greenhouse gas emissions data for this reporting period.</p>

      <!-- Gases Included in the Calculation Section -->
      <div id="gases_included_section" class="w-full mt-8">
        <label for="gases_included" class="block pb-2 text-base font-medium">Gases included in the calculation</label>
        <div id="gases_included_list" class="space-y-4">
          <div class="gases-item flex gap-4 items-center">
            <!-- Gas Dropdown -->
            <select name="gases_included[]" class="w-3/5 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition">
              <option value="">Select gases included</option>
              <option value="CO2">CO₂ (Carbon Dioxide)</option>
              <option value="CH4">CH₄ (Methane)</option>
              <option value="N2O">N₂O (Nitrous Oxide)</option>
              <option value="HFCs">HFCs (Hydrofluorocarbons)</option>
              <option value="PFCs">PFCs (Perfluorocarbons)</option>
              <option value="SF6">SF₆ (Sulfur Hexafluoride)</option>
              <option value="NF3">NF₃ (Nitrogen Trifluoride)</option>
            </select>

            <!-- Quantity Input Field -->
            <input type="number" min="0" step="1" name="gases_quantity[]" placeholder="0" class="w-1/4 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition" />
            <button
              type="button"
              id="scope3_add_item"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-xl text-teal-700 text-sm font-medium transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
              </svg>
              Add
            </button>
          </div>
        </div>

        <!-- Total Gases Count Section -->
        <div id="total_gases_count" class="mt-4 text-gray-500 text-lg font-semibold">
          Total gases selected: <span id="gases_count">0</span>
        </div>
      </div>

      <!-- Biogenic CO2 Emissions -->
      <div class="w-full mt-8">
        <label for="biogenic_co2_emissions" class="block pb-2 text-base font-medium">Biogenic CO₂ emissions in metric tons</label>
        <input type="number" min="0" name="biogenic_co2_emissions" id="biogenic_co2_emissions"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition" />
        <p class="mt-2 text-gray-500 text-sm">Provide biogenic CO₂ emissions in metric tons of CO₂ equivalent.</p>
      </div>

      <!-- Other Indirect (Scope 3) Emissions Categories -->
      <div class="w-full mt-8">
        <label for="other_scope3_emissions" class="block pb-2 text-base font-medium">Other indirect (Scope 3) emissions categories</label>
        <textarea name="other_scope3_emissions" id="other_scope3_emissions" rows="3"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"></textarea>
        <p class="mt-2 text-gray-500 text-sm">Provide additional indirect emissions categories and activities included in the calculation.</p>
      </div>

      <!-- Base Year for Calculation -->
      <div class="w-full mt-8">
        <label for="base_year_scope3" class="block pb-2 text-base font-medium">Base year for calculation (if applicable)</label>
        <input type="number" min="1900" max="2100" name="base_year_scope3" id="base_year_scope3"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition" />
        <p class="mt-2 text-gray-500 text-sm">Provide the rationale for selecting the base year and context for any significant changes in emissions that triggered recalculations.</p>
      </div>

      <!-- Emission Factors and GWP Rates -->
      <div class="w-full mt-8">
        <label for="emission_factors_scope3" class="block pb-2 text-base font-medium">Source of emission factors and GWP rates used</label>
        <textarea name="emission_factors_scope3" id="emission_factors_scope3" rows="3"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"></textarea>
        <p class="mt-2 text-gray-500 text-sm">Provide details of the sources used for emission factors and GWP rates.</p>
      </div>

      <!-- Consolidation Approach -->
      <div class="w-full mt-8">
        <label for="consolidation_approach" class="block pb-2 text-base font-medium">Consolidation approach for emissions</label>
        <div class="flex flex-col gap-4 mt-2">
          <!-- Checkbox for Equity Share -->
          <label class="flex items-center gap-2 text-base text-black">
            <input type="checkbox" name="consolidation_approach[]" value="equity_share" class="w-5 h-5 border border-gray-300 rounded">
            Equity Share
          </label>

          <!-- Checkbox for Financial Control -->
          <label class="flex items-center gap-2 text-base text-black">
            <input type="checkbox" name="consolidation_approach[]" value="financial_control" class="w-5 h-5 border border-gray-300 rounded">
            Financial Control
          </label>

          <!-- Checkbox for Operational Control -->
          <label class="flex items-center gap-2 text-base text-black">
            <input type="checkbox" name="consolidation_approach[]" value="operational_control" class="w-5 h-5 border border-gray-300 rounded">
            Operational Control
          </label>
        </div>
        <p class="mt-2 text-gray-500 text-sm">Choose the approach used for emissions consolidation.</p>
      </div>

      <!-- Standards, Methodologies, Assumptions, and Calculation Tools -->
      <div class="w-full mt-8">
        <label for="standards_tools_scope3" class="block pb-2 text-base font-medium">Standards, methodologies, assumptions, and/or calculation tools used</label>
        <textarea name="standards_tools_scope3" id="standards_tools_scope3" rows="3"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"></textarea>
        <p class="mt-2 text-gray-500 text-sm">Provide details of the standards, methodologies, assumptions, and calculation tools used for Scope 3 emissions.</p>
      </div>

      <!-- Total Summary Section -->
      <div class="mt-10 pr-8 md:pr-12 lg:pr-16">
        <h4 class="text-2xl font-semibold text-teal-700">Total Summary (automatic)</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mt-4">
          <div>
            <div class="text-gray-500">Total Gross Direct GHG Emissions (tCO₂e)</div>
            <div class="text-3xl text-teal-700 font-semibold" id="total_gross_emissions">0</div>
          </div>
          <div>
            <div class="text-gray-500">Total Biogenic CO₂ Emissions (tCO₂e)</div>
            <div class="text-3xl text-teal-700 font-semibold" id="total_biogenic_emissions">0</div>
          </div>
          <div>
            <div class="text-gray-500">Total Emissions (Scope 3)</div>
            <div class="text-3xl text-teal-700 font-semibold">
              <span id="total_emissions">0.00</span><span class="text-xl">tCO₂e</span>
            </div>
          </div>
        </div>
        <p class="mt-3 text-sm text-gray-500">
          Total emissions formula: <span class="font-medium">Gross Emissions + Biogenic CO₂ Emissions</span>
        </p>
      </div>

      <!-- Right corner buttons -->
      <div class="flex justify-end gap-4 mt-10 w-full">
        <button type="button" onclick="window.history.back()"
          class="px-8 py-2 text-base font-medium text-center text-teal-700 border-teal-700 border border-solid whitespace-nowrap bg-white rounded-xl hover:bg-teal-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors">
          Previous
        </button>
        <button type="submit"
          class="px-8 py-2 text-base font-medium text-center text-white whitespace-nowrap bg-lime-500 rounded-xl hover:bg-lime-600 focus:outline-none focus:ring-2 focus:ring-lime-500 focus:ring-offset-2 transition-colors">
          Save
        </button>
      </div>
    </section>
  </form>
</main>

<script>
// Handle adding gases entries dynamically
document.querySelector('#scope3_add_item').addEventListener('click', function() {
  addGasesEntry();
});

// Function to add a new gases entry
function addGasesEntry() {
  const gasesList = document.getElementById('gases_included_list');
  const newItem = document.createElement('div');
  newItem.classList.add('gases-item', 'flex', 'gap-4', 'items-center');
  newItem.innerHTML = `
    <select name="gases_included[]" class="w-3/5 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition">
      <option value="">Select gases included</option>
      <option value="CO2">CO₂ (Carbon Dioxide)</option>
      <option value="CH4">CH₄ (Methane)</option>
      <option value="N2O">N₂O (Nitrous Oxide)</option>
      <option value="HFCs">HFCs (Hydrofluorocarbons)</option>
      <option value="PFCs">PFCs (Perfluorocarbons)</option>
      <option value="SF6">SF₆ (Sulfur Hexafluoride)</option>
      <option value="NF3">NF₃ (Nitrogen Trifluoride)</option>
    </select>
    <input type="number" min="0" step="1" name="gases_quantity[]" placeholder="0" class="w-1/4 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition" />
    <button type="button" class="remove-gases-entry p-2 rounded-xl border border-red-500 text-red-500 hover:bg-red-500 hover:text-white transition">
      Remove
    </button>
  `;

  // Append the new item to the gases list
  gasesList.appendChild(newItem);

  // Handle remove button click for this new entry
  newItem.querySelector('.remove-gases-entry').addEventListener('click', function() {
    newItem.remove();
    updateGasesCount();
  });

  // Update gases count after adding a new entry
  updateGasesCount();
}

// Update the gases count dynamically
function updateGasesCount() {
  const gasesCount = document.querySelectorAll('[name="gases_included[]"]').length;
  document.getElementById('gases_count').innerText = gasesCount;
}

// Update Total GHG Emissions Intensity summary
const intensityInput = document.getElementById('gross_market_based_emissions');
function updateTotalIntensity() {
  const emissionsIntensity = parseFloat(intensityInput.value) || 0;
  document.getElementById('total_ghg_intensity').innerText = emissionsIntensity.toFixed(4);
}

intensityInput.addEventListener('input', updateTotalIntensity);
</script>
