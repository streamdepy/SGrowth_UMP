<main class="flex flex-col ml-48 self-center mb-16 mt-16 w-full max-w-[1256px] max-md:mt-10 max-md:max-w-full">
  <header class="flex gap-3.5 self-start">
    <img
      src="https://api.builder.io/api/v1/image/assets/TEMP/1c71a2a9be3de365531c3991c3339c7e3c083b53?width=462"
      alt="GRI Environment icon"
      class="object-contain shrink-0 my-auto rounded-full aspect-[1.04] w-[58px]"
    />
    <div class="flex flex-col">
      <h2 class="text-4xl font-semibold text-black">GRI Environment</h2>
      <p class="self-center text-xl font-medium leading-none text-center text-gray-500">
        Environmental Performance
      </p>
    </div>
  </header>

  <form action="/mitra/env-3" method="GET">
    <!-- Scope 2 GHG Emissions (Indirect Energy) -->
    <section class="flex flex-col items-start py-14 px-16 mt-10 w-full bg-white rounded-2xl shadow-2xl max-w-[981px] max-md:px-5">
      <h3 class="text-3xl font-semibold text-teal-700">Indirect (Scope 2) GHG Emissions (305-2)</h3>
      <p class="mt-3 text-gray-500">Fill in the indirect (Scope 2) greenhouse gas emissions data for this reporting period.</p>

      <!-- Gases Included in the Calculation Section -->
      <div id="gases_included_section" class="w-full mt-8">
        <label for="gases_included" class="block pb-2 text-base font-medium">Gases included in the calculation</label>
        <div id="gases_included_list" class="space-y-4">
          <div class="gases-item flex gap-4 items-center">
            <!-- Gas Dropdown -->
            <select name="gases_included[]" class="w-3/5 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition">
              <option value="">Select gases included</option>
              <option value="CO2">CO₂ (Carbon Dioxide)</option>
              <option value="CH4">CH₄ (Methane)</option>
              <option value="N2O">N₂O (Nitrous Oxide)</option>
              <option value="HFCs">HFCs (Hydrofluorocarbons)</option>
              <option value="PFCs">PFCs (Perfluorocarbons)</option>
              <option value="SF6">SF₆ (Sulfur Hexafluoride)</option>
              <option value="NF3">NF₃ (Nitrogen Trifluoride)</option>
            </select>

            <!-- Quantity Input Field -->
            <input type="number" min="0" step="1" name="gases_quantity[]" placeholder="0" class="w-1/4 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition" />
            <button
              type="button"
              id="scope2_add_item"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-xl text-teal-700 text-sm font-medium transition"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
              </svg>
              Add
            </button>
      
          </div>
        </div>

        <!-- Total Gases Count Section -->
        <div id="total_gases_count" class="mt-4 text-gray-500 text-lg font-semibold">
          Total gases selected: <span id="gases_count">0</span>
        </div>
      </div>


            <!-- Base year info -->
            <div class="w-full mt-6">
              <label class="block pb-2 text-base font-medium">
                Base year information (if applicable)
              </label>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <span class="block text-sm font-medium text-gray-700">Base year</span>
                  <input
                    type="number"
                    min="1900"
                    max="2100"
                    name="s1[0][base_year]"
                    placeholder="e.g., 2020"
                    class="w-full px-4 py-3 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"
                  />
                </div>
                <div>
                  <span class="block text-sm font-medium text-gray-700">
                    Emissions in base year (tCO₂e)
                  </span>
                  <input
                    type="number"
                    min="0"
                    step="0.0001"
                    name="s1[0][base_emissions]"
                    placeholder="0.0000"
                    class="w-full px-4 py-3 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"
                  />
                </div>
                <div>
                  <span class="block text-sm font-medium text-gray-700">
                    Is base year still valid?
                  </span>
                  <select
                    name="s1[0][base_still_valid]"
                    class="w-full px-4 py-3 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"
                  >
                    <option value="">Select</option>
                    <option value="yes">Yes</option>
                    <option value="recalculated">Recalculated</option>
                    <option value="not_applicable">Not applicable</option>
                  </select>
                </div>
              </div>

              <textarea
                name="s1[0][base_context]"
                rows="3"
                placeholder="Explain the rationale for choosing the base year and any significant changes in emissions that triggered recalculations of base year emissions."
                class="w-full px-4 py-3 mt-4 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"
              ></textarea>
            </div>
            
      <!-- Emission Factors and GWP Rates -->
      <div class="w-full mt-8">
        <label for="emission_factors_scope2" class="block pb-2 text-base font-medium">Source of emission factors and GWP rates used</label>
        <textarea name="emission_factors_scope2" id="emission_factors_scope2" rows="3"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"></textarea>
        <p class="mt-2 text-gray-500 text-sm">Provide details of the sources used for emission factors and GWP rates.</p>
      </div>

      <!-- Consolidation Approach -->
      <div class="w-full mt-8">
        <label for="consolidation_approach" class="block pb-2 text-base font-medium">Consolidation approach for emissions</label>
        <div class="flex flex-col gap-4 mt-2">
          <!-- Checkbox for Equity Share -->
          <label class="flex items-center gap-2 text-base text-black">
            <input type="checkbox" name="consolidation_approach[]" value="equity_share" class="w-5 h-5 border border-gray-300 rounded">
            Equity Share
          </label>

          <!-- Checkbox for Financial Control -->
          <label class="flex items-center gap-2 text-base text-black">
            <input type="checkbox" name="consolidation_approach[]" value="financial_control" class="w-5 h-5 border border-gray-300 rounded">
            Financial Control
          </label>

          <!-- Checkbox for Operational Control -->
          <label class="flex items-center gap-2 text-base text-black">
            <input type="checkbox" name="consolidation_approach[]" value="operational_control" class="w-5 h-5 border border-gray-300 rounded">
            Operational Control
          </label>
        </div>
        <p class="mt-2 text-gray-500 text-sm">Choose the approach used for emissions consolidation.</p>
      </div>


      <!-- Standards, Methodologies, Assumptions, and Calculation Tools -->
      <div class="w-full mt-8">
        <label for="standards_tools_scope2" class="block pb-2 text-base font-medium">Standards, methodologies, assumptions, and/or calculation tools used</label>
        <textarea name="standards_tools_scope2" id="standards_tools_scope2" rows="3"
          class="w-full px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition"></textarea>
        <p class="mt-2 text-gray-500 text-sm">Provide details of the standards, methodologies, assumptions, and calculation tools used for Scope 2 emissions.</p>
      </div>

      <!-- Total Summary Section -->
      <div class="mt-10 pr-8 md:pr-12 lg:pr-16">
        <h4 class="text-2xl font-semibold text-teal-700">Total Summary (automatic)</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mt-4">
          <div>
            <div class="text-gray-500">Total Gross Market-Based Scope 2 Emissions (tCO₂e)</div>
            <div class="text-3xl text-teal-700 font-semibold" id="total_market_based_emissions">0</div>
          </div>
        </div>
        <p class="mt-3 text-sm text-gray-500">
          Total emissions formula: <span class="font-medium">Market-Based Emissions</span>
        </p>
      </div>

      <!-- Right corner buttons -->
      <div class="flex justify-end gap-4 mt-10 w-full">
        <button type="button" onclick="window.history.back()"
          class="px-8 py-2 text-base font-medium text-center text-teal-700 border-teal-700 border border-solid whitespace-nowrap bg-white rounded-xl hover:bg-teal-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors">
          Previous
        </button>
        <button type="submit"
          class="px-8 py-2 text-base font-medium text-center text-white whitespace-nowrap bg-lime-500 rounded-xl hover:bg-lime-600 focus:outline-none focus:ring-2 focus:ring-lime-500 focus:ring-offset-2 transition-colors">
          Save
        </button>
      </div>
    </section>
  </form>
</main>

<script>
// Handle adding gases entries dynamically
document.querySelector('#scope2_add_item').addEventListener('click', function() {
  addGasesEntry();
});

// Function to add a new gases entry
function addGasesEntry() {
  const gasesList = document.getElementById('gases_included_list');
  const newItem = document.createElement('div');
  newItem.classList.add('gases-item', 'flex', 'gap-4', 'items-center');
  newItem.innerHTML = `
    <select name="gases_included[]" class="w-3/5 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition">
      <option value="">Select gases included</option>
      <option value="CO2">CO₂ (Carbon Dioxide)</option>
      <option value="CH4">CH₄ (Methane)</option>
      <option value="N2O">N₂O (Nitrous Oxide)</option>
      <option value="HFCs">HFCs (Hydrofluorocarbons)</option>
      <option value="PFCs">PFCs (Perfluorocarbons)</option>
      <option value="SF6">SF₆ (Sulfur Hexafluoride)</option>
      <option value="NF3">NF₃ (Nitrogen Trifluoride)</option>
    </select>
    <input type="number" min="0" step="1" name="gases_quantity[]" placeholder="0" class="w-1/4 px-8 py-4 mt-2 text-base text-black rounded-2xl border border-gray-300 bg-slate-50 outline-none hover:ring focus:ring-2 focus:ring-teal-600 transition" />
    <button type="button" class="remove-gases-entry p-2 rounded-xl border border-red-500 text-red-500 hover:bg-red-500 hover:text-white transition">
      Remove
    </button>
  `;

  // Append the new item to the gases list
  gasesList.appendChild(newItem);

  // Handle remove button click for this new entry
  newItem.querySelector('.remove-gases-entry').addEventListener('click', function() {
    newItem.remove();
    updateGasesCount();
  });

  // Update gases count after adding a new entry
  updateGasesCount();
}

// Update the gases count dynamically
function updateGasesCount() {
  const gasesCount = document.querySelectorAll('[name="gases_included[]"]').length;
  document.getElementById('gases_count').innerText = gasesCount;
}

// Update Total Emissions summary
const marketBasedEmissionsInput = document.getElementById('gross_market_based_emissions');
function updateTotalEmissions() {
  const marketBasedEmissions = parseFloat(marketBasedEmissionsInput.value) || 0;
  document.getElementById('total_market_based_emissions').innerText = marketBasedEmissions.toFixed(4);
}

marketBasedEmissionsInput.addEventListener('input', updateTotalEmissions);

</script>
